clear

as=[   0 -14.7457
   1 -11.9488
   2  -5.3986
   3   7.0006
   4  16.9567
   5  14.3754
   6   0.6664
   7 -14.5859
   8 -18.3685
   9 -13.7641
  10  -0.9088
  11  13.7462
  12  17.4402
  13  15.0043
  14   1.9806
  15 -12.2474
  16 -16.7810
  17  -8.5208
  18   7.5684
  19  22.6228
  20  23.2300
  21   9.9050
  22 -11.6671
  23 -26.0454
  24 -27.0578
  25  -8.4764
  26  15.5141
  27  30.5163
  28  25.2720
  29   5.3362
  30 -14.5029
  31 -28.7076
  32 -26.0573
  33 -11.3979
  34   7.1474
  35  24.5318
  36  28.0827
  37  19.3796
  38  -0.3098
  39 -16.5873
  40 -20.6882
  41 -13.7234
  42   0.6918
  43  14.3714
  44  15.9492
  45   9.0762
  46  -4.0050
  47 -17.2153
  48 -17.7159
  49  -6.2774
  50   7.8806
  51  18.6456
  52  14.9427
  53   6.6099
  54  -4.7752
  55 -10.9942
  56 -10.0023
  57  -2.1646
  58   8.9335
  59  11.8951
  60   6.2751
  61  -4.5225
  62 -10.7856
  63 -12.3135
  64  -6.1670
  65   2.6130
  66   7.9566
  67   8.0631
  68   4.0730
  69  -2.2023
  70  -6.0897
  71  -7.0198
  72  -6.9249
  73  -4.8650
  74  -3.9146
  75   3.1798
  76   4.9949
  77   2.8642
  78   0.3791
  79  -3.4597
  80  -4.7241
  81  -4.3912
  82  -1.0084
  83   2.6218
  84   1.8330
  85   0.9710
  86  -3.1170
  87  -4.8040
  88  -5.3768
  89   0.2292
  90   8.2467
  91  14.0556
  92  14.8204
  93   7.8193
  94  -3.0693
  95 -14.5051
  96 -15.8842
  97  -6.5114
  98   4.2935
  99   8.9706
 100  10.9057
 101   3.9552
 102  -5.6305
 103 -12.8288
 104  -9.5801
 105  -3.9404
 106   1.7892
 107   3.6087
 108   3.1182
 109  -0.1326
 110  -3.1412
 111  -4.2049
 112  -4.0309
 113  -1.3364
 114  -1.1045
 115  -0.0857
 116   1.8255
 117   4.5325
 118   4.9984
 119   1.2893
 120  -0.5284
 121  -1.2222
 122  -3.1073
 123  -1.7272
 124   1.0217
 125   5.4575
 126   9.7795
 127  11.5271
 128   3.0237
 129  -4.4104
 130  -5.6646
 131  -2.4271
 132  -0.6796
 133  -0.2463
 134  -2.4380
 135  -4.9138
 136  -1.6517
 137   2.7323
 138   1.5553
 139  -2.8823
 140  -9.4362
 141 -11.4817
 142  -5.8486
 143   3.0920
 144  10.2878
 145   8.4383
 146   4.4757
 147  -5.7502
 148 -16.1805
 149 -17.9113
 150  -8.3230
 151   1.7241
 152  11.4332
 153  17.6160
 154  12.4035
 155   2.1560
 156  -9.7910
 157 -11.6736
 158  -5.9728
 159  -0.2553
 160   3.0928
 161   6.9988
 162   9.7853
 163   8.8031
 164  -1.2076
 165  -8.1616
 166 -10.8280
 167  -8.3051
 168  -3.5471
 169   0.4539
 170   0.5473
 171  -2.8453
 172  -7.2798
 173  -4.9833
 174  -3.6996
 175   2.0552
 176   7.2213
 177   7.2343
 178   0.8567
 179  -8.3792
 180 -11.4992
 181  -9.2747
 182  -0.9402
 183  11.4353
 184  15.7538
 185   8.2508
 186  -5.3497
 187 -19.0211
 188 -24.1638
 189 -19.2541
 190  -0.2990
 191  21.8660
 192  31.6417
 193  26.6080
 194   7.5583
 195 -18.8926
 196 -34.6843
 197 -32.8445
 198 -15.4474
 199   7.6585
]
figure;
subplot(1,1,1);            % make 3 by 2 sub-panels
          



as =as(:,2);
order=50
pred = as(1:100);
b=arburg( as(1:100),order);
b=b';
pred(101:200)=0;
for t=101:1:200
    temp=0;
    for k=1:1:(order)
        
        temp=temp-b(k+1)*pred(t-k);
       
    end
    pred(t)=temp;
end
%plot([1:200],pred,'r',[1:200],as,'b')
ylabel('amplitude');
xlabel('blue for samples and red for predicted time series');
title('AR prediction with order 50');

sr=200;
nyq=sr/2;
x=linspace(0,2*nyq,2*sr-1);



figure;

subplot(3,1,1);            % make 3 by 2 sub-panels

xcor=xcorr(as,as);
size(xcor)
plot(x,abs(fft(xcor)));
xlim([0 nyq])
xlabel('x');
ylabel('power spectrum');
title('original data');


subplot(3,1,2);

as1(1:100)=as(1:100);
as1(101:200)=0;
xcor=xcorr(as1,as1);
plot(x,abs(fft(xcor)));
xlim([0 nyq]);
xlabel('x');
ylabel('power spectrum');
title('first 100 points padded with zeros to 200 points');



subplot(3,1,3);

as2(1:100)=as(1:100);
as2(101:200)=pred(101:200);
xcor=xcorr(as2,as2);
plot(x,abs(fft(xcor)));
xlim([0 nyq]);
xlabel('x');
ylabel('power spectrum');
title('the 200 points time series with last 100 points created by prediction(order 50)');


%plot(,abs(fft(xcorr(a1+b1*i,a1+b1*i))






