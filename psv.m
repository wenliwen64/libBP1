alpha1=5;
alpha2=8.0;
beta1=alpha1/1.732;
beta2=4.6;
rho1=2.667;
rho2=3.38;
theta = linspace(0,90,91);
theta_rad=theta*pi/180;
p=sin(theta_rad)/alpha1;
eta_a1=cos(theta_rad)/alpha1;
eta_a2=cos(asin(p*alpha2))/alpha2;
eta_b1=cos(asin(p*beta1))/beta1;
eta_b2=cos(asin(p*beta2))/beta2;
a=rho2*(1-2*beta2^2*p.^2)-rho1*(1-2*beta1^2*p.^2);
b=rho2*(1-2*beta2^2*p.^2)+2*rho1*beta1^2*p.^2;
c=rho1*(1-2*beta1^2*p.^2)+2*rho2*beta2^2*p.^2;
d=2*(rho2*beta2^2-rho1*beta1^2);
E=b.*eta_a1+c.*eta_a2;
F=b.*eta_b1+c.*eta_b2;
G=a-d*eta_a1.*eta_b2;
H=a-d*eta_a2.*eta_b1;
D=E.*F+G.*H.*p.^2;
Rpp=((b.*eta_a1-c.*eta_a2).*F-(a+d.*eta_a1.*eta_b2).*H.*p.^2)./D;
Rps=-(2*eta_a1.*(a.*b+c*d.*eta_a2.*eta_b2).*p*(alpha1/beta1))./D;
Tpp=(2*rho1*eta_a1.*F.*(alpha1/alpha2))./D;
Tps=(2*rho1*eta_a1.*H.*p.*(alpha1/beta2))./D;
subplot(2,1,1);
plot(theta,abs(Rpp),'r-',theta,abs(Rps),'b-',theta,abs(Tpp),'g-',theta,abs(Tps),'black-');
legend('Reflected P','Reflected S','Refracted T','Refracted S');
title('Amplitude');
subplot(2,1,2);
plot(theta,angle(Rpp),'r-',theta,angle(Rps),'b-',theta,angle(Tpp),'g-',theta,angle(Tps),'black-');
legend('Reflected P','Reflected S','Refracted T','Refracted S');
title('Phase');